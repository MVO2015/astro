<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head lang="en">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="ai.css">
    <link rel="stylesheet" href="zodiac.css">
    <link rel="stylesheet" href="astro.css">
    <title></title>
</head>
<style>

</style>
<body>
<h1>Astronomical Clock</h1>
        <svg id="wall" viewbox="-500, -500, 1000, 1000">
            <defs>
                <clipPath id="clipPathCancriTropicus">
                    <circle id="clipCircleCancriTropicus" cx="0" cy="0" r="0"></circle>
                </clipPath>
            </defs>
            <g id="clockFace" transform="rotate(180) scale(-1, 1)">
                <circle id="cancriTropicus" display="none" r="0" cx="0" cy="0" fill="green" stroke="green" fill-opacity="0.2"/>
                <circle id="equator" display="none" r="0" cx="0"cy="0" fill="violet" stroke="violet" fill-opacity="0.2"/>
                <circle id="capricorniTropicus" display="none" r="0" cx="0" cy="0" fill="orange" stroke="orange" fill-opacity="0.2"/>
                <circle id="latitudoHorizontis" display="none" r="0" cx="0" cy="0" fill="beige" stroke="red" clip-path="url(#clipPathCancriTropicus)"/>
                <circle id="opacusHorizontis" display="none" r="0" cx="0" cy="0" fill="black" stroke="black" fill-opacity="0.2"/>
                <circle id="orbis" display="none" r="0" cx="0" cy="0" stroke="blue" fill="white"/>
                <g id="zodiacum">
                    <circle id="zodiacumCircle" display="none" r="0" cx="0" cy="0" stroke="cyan" stroke-width="2" fill="cyan" fill-opacity="0.2"></circle>
                    <line id ="zodiacumEquinox" display = "none" x1="0" y1="0" x2="0" y2="0"  stroke="cyan" stroke-width="2"></line>
                    <line id ="zodiacumSolstice" display = "none" x1="0" y1="0" x2="0" y2="0"  stroke="cyan" stroke-width="2"></line>
                </g>
                <g id="numbers" transform="rotate(-90) scale(-1, 1)" display="none">
                    <g id="position0">
                        <text id="number0" x="-10" y="0">XII</text>
                    </g>
                    <g id="position1">
                        <text id="number1" x="-10" y="0">I</text>
                    </g>
                    <g id="position2">
                        <text id="number2" x="-10" y="0">II</text>
                    </g>
                    <g id="position3">
                        <text id="number3" x="-10" y="0">III</text>
                    </g>
                    <g id="position4">
                        <text id="number4" x="-10" y="0">IV</text>
                    </g>
                    <g id="position5">
                        <text id="number5" x="-10" y="0">V</text>
                    </g>
                    <g id="position6">
                        <text id="number6" x="-10" y="0">VI</text>
                    </g>
                    <g id="position7">
                        <text id="number7" x="-10" y="0">VII</text>
                    </g>
                    <g id="position8">
                        <text id="number8" x="-10" y="0">VIII</text>
                    </g>
                    <g id="position9">
                        <text id="number9" x="-10" y="0">IX</text>
                    </g>
                    <g id="position10">
                        <text id="number10" x="-10" y="0">X</text>
                    </g>
                    <g id="position11">
                        <text id="number11" x="-10" y="0">XI</text>
                    </g>
                    <g id="position12">
                        <text id="number12" x="-10" y="0">XII</text>
                    </g>
                    <g id="position13">
                        <text id="number13" x="-10" y="0">I</text>
                    </g>
                    <g id="position14">
                        <text id="number14" x="-10" y="0">II</text>
                    </g>
                    <g id="position15">
                        <text id="number15" x="-10" y="0">III</text>
                    </g>
                    <g id="position16">
                        <text id="number16" x="-10" y="0">IV</text>
                    </g>
                    <g id="position17">
                        <text id="number17" x="-10" y="0">V</text>
                    </g>
                    <g id="position18">
                        <text id="number18" x="-10" y="0">VI</text>
                    </g>
                    <g id="position19">
                        <text id="number19" x="-10" y="0">VII</text>
                    </g>
                    <g id="position20">
                        <text id="number20" x="-10" y="0">VIII</text>
                    </g>
                    <g id="position21">
                        <text id="number21" x="-10" y="0">IX</text>
                    </g>
                    <g id="position22">
                        <text id="number22" x="-10" y="0">X</text>
                    </g>
                    <g id="position23">
                        <text id="number23" x="-10" y="0">XI</text>
                    </g>
                    <line id="sunTime" x1="0" y1="0" x2="0" y2="0" stroke="black" stroke-width="3"></line>
                    <g id="sunPosition">
                        <text id="sunSymbol" x="-8" y="5">&#9788;</text>
                    </g>

                </g>

                <g id="design" opacity="1">
                    <line id="orbisEquator" display="none" x1="0" y1="0" x2="0" y2="0" stroke="violet" stroke-width="2"/>
                    <line id="orbisCancriTropicus" display="none" x1="0" y1="0" x2="0" y2="0" stroke="green" stroke-width="2"/>
                    <line id="orbisCapricorniTropicus" display="none" x1="0" y1="0" x2="0" y2="0" stroke="orange" stroke-width="2"/>
                    <line id="orbisLatitudo" display="none" x1="0" y1="0" x2="0" y2="0" stroke="red" stroke-width="2"/>
                    <line id="orbisOpacus" display="none" x1="0" y1="0" x2="0" y2="0" stroke="black" stroke-width="2"/>
                    <line id="orbisAxonX" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="orbisAxonY" display="none" x1="0" y1="0" x2="0" y2="0"  stroke="lightgrey"/>
                    <circle id="orbisCenter" display="none" r="0" cx="0" cy="0" fill="lightgrey"/>
                    <line id="planum" display="none" x1="0" y1="0" x2="0" y2="0"  stroke="grey"/>
                    <line id="equatorProjection" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="cancriTropicusProjection" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="capricorniTropicusProjection" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="latitudoProjectionA" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="latitudoProjectionB" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="opacusProjectionA" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="opacusProjectionB" display="none" x1="0" y1="0" x2="0" y2="0" stroke="lightgrey"/>
                    <line id="axonX" display="none" x1="0" y1="0" x2="0" y2="0" />
                    <line id="axonY" display="none" x1="0" y1="0" x2="0" y2="0" />
                </g>
                <g id="clickMe" display="inline">
                    <circle id="clickMeFlash" display="inline" r="10" cx="0" cy="0"/>
                    <circle id="clickMePoint" display="none" r="0" cx="0" cy="0" fill="violet"/>
                </g>
            </g>
        </svg>
<div id="zodiac">
    <div id="aries" class="zodiac-symbol"><i class="ai aries"></i></div>
    <div id="taurus" class="zodiac-symbol"><i class="ai taurus"></i></div>
    <div id="gemini" class="zodiac-symbol"><i class="ai gemini"></i></div>
    <div id="cancer" class="zodiac-symbol"><i class="ai cancer"></i></div>
    <div id="leo" class="zodiac-symbol"><i class="ai leo"></i></div>
    <div id="virgo" class="zodiac-symbol"><i class="ai virgo"></i></div>
    <div id="libra" class="zodiac-symbol"><i class="ai libra"></i></div>
    <div id="scorpio" class="zodiac-symbol"><i class="ai scorpio"></i></div>
    <div id="sagittarius" class="zodiac-symbol"><i class="ai sagittarius"></i></div>
    <div id="capricorn" class="zodiac-symbol"><i class="ai capricorn"></i></div>
    <div id="aquarius" class="zodiac-symbol"><i class="ai aquarius"></i></div>
    <div id="pisces" class="zodiac-symbol"><i class="ai pisces"></i></div>
</div>
<p id="text"></p>
</body>
<script>
//    var wall = {width: 400, height: 400, border: "solid red 1px"};
    var center = {left: 200, top:200};
    var orbisDecl = deg2rad(23.5);
    var latitudos = deg2rad(50);
    var horizontis = Math.PI / 2 - latitudos;
    var opacus = deg2rad(18);

    function scale(num)
    {
        return (100 * num).toString();
    }

    var orbisCenter = {
        id: "orbisCenter",
        x: 0,
        y: null,
        init: function () {
            this.y = orbis.r;
        }
    };

    var orbis = {
        id: "orbis",
        r: 0.5,
        cx: 0,
        cy: null,
        init: function() {
            this.cy = this.r
        }
    };

    var orbisAxonX = {
        id: "orbisAxonX",
        x1: null,
        y1: null,
        x2: null,
        y2: null,
        overlap: 0.1,
        init: function() {
            this.x1 = -orbis.r - this.overlap;
            this.y1 = orbis.r;
            this.x2 = orbis.r + this.overlap;
            this.y2 = orbis.r;
        }
    };
    var orbisAxonY = {
        id: "orbisAxonY",
        x1: 0,
        y1: null,
        x2: 0,
        y2: null,
        overlap: 0.1,
        init: function() {
            this.y1 = - this.overlap;
            this.y2 = 2 * orbis.r + this.overlap;
        }
    };

    var orbisEquator = {
        id: "orbisEquator",
        x1: null,
        y1: null,
        x2: null,
        y2: null,
        init: function () {
            this.x1 = -orbis.r;
            this.y1 = orbis.r;
            this.x2 = orbis.r;
            this.y2 = orbis.r;
        }
    };

    var clickMePoint = {
        id: "clickMePoint",
        x: 0,
        y: 0,
        init: function () {
        }
    };

    var orbisCancriTropicus = {
        id: "orbisCancriTropicus",
        x1: null,
        y1: null,
        x2: null,
        y2: null,
        init: function () {
            var orbisX = Math.cos(orbisDecl) * orbis.r;
            var orbisY = Math.sin(orbisDecl) * orbis.r;
            this.x1 = orbisCenter.x - orbisX;
            this.y1 = orbisCenter.y + orbisY;
            this.x2 = orbisCenter.x + orbisX;
            this.y2 = this.y1;
        }
    };

    var orbisCapricorniTropicus = {
        id: "orbisCapricorniTropicus",
        x1: null,
        y1: null,
        x2: null,
        y2: null,
        init: function () {
            var orbisX = Math.cos(orbisDecl) * orbis.r;
            var orbisY = - Math.sin(orbisDecl) * orbis.r;
            this.x1 = orbisCenter.x - orbisX;
            this.y1 = orbisCenter.y + orbisY;
            this.x2 = orbisCenter.x + orbisX;
            this.y2 = this.y1;
        }
    };

    var orbisLatitudo = {
        id: "orbisLatitudo",
        x1: null,
        y1: null,
        x2: null,
        y2: null,
        init: function () {
            var orbisX = Math.cos(-horizontis) * orbis.r;
            var orbisY = Math.sin(-horizontis) * orbis.r;
            this.x1 = orbisCenter.x - orbisX;
            this.y1 = orbisCenter.y + orbisY;
            this.x2 = orbisCenter.x + orbisX;
            this.y2 = orbisCenter.y - orbisY;
        }
    };

    var orbisOpacus = {
        id: "orbisOpacus",
        x1: null,
        y1: null,
        x2: null,
        y2: null,
        init: function () {
            var orbisX1 = Math.cos(oppositeAngle(horizontis + opacus)) * orbis.r;
            var orbisY1 = Math.sin(oppositeAngle(horizontis + opacus)) * orbis.r;
            var orbisX2 = Math.cos(horizontis - opacus) * orbis.r;
            var orbisY2 = Math.sin(horizontis - opacus) * orbis.r;
            this.x1 = orbisCenter.x + orbisX1;
            this.y1 = orbisCenter.y + orbisY1;
            this.x2 = orbisCenter.x + orbisX2;
            this.y2 = orbisCenter.y + orbisY2;
        }
    };

    var planum = {
        id: "planum",
        x1: null,
        y1: 0,
        x2: null,
        y2: 0,
        overlap: 0.1,
        init: function () {
            var planumX = projection(orbisDecl) + this.overlap;
            this.x1 = planumX;
            this.x2 = -planumX;
        }
    };

    var equatorProjection = {
        id: "equatorProjection",
        x1: 0,
        y1: null,
        x2: null,
        y2: 0,
        overlap: 0.1,
        x: null,
        y: null,
        init: function () {
            this.x = - projection(0);
            this.y = 0;
            this.x1 = this.overlap;
            this.y1 = 2 * orbis.r + this.overlap;
            this.x2 = this.x - this.overlap;
            this.y2 = this.y - this.overlap;
        }
    };

    var equator = {
        id: "equator",
        r: null,
        cx: 0,
        cy: 0,
        init: function () {
            this.r = projection(0);
        }

    };

    var cancriTropicusProjection = {
        id: "cancriTropicusProjection",
        x1: 0,
        y1: null,
        x2: null,
        y2: 0,
        x: null,
        y: 0,
        init: function () {
            this.x = this.x2;
            this.y = 0;
            this.y1 = 2 * orbis.r;
            this.x2 = - projection(orbisDecl);
            this.x = this.x2;
        }
    };

    var cancriTropicus = {
        id: "cancriTropicus",
        r: null,
        cx: 0,
        cy: 0,
        init: function () {
            this.r = projection(orbisDecl);
        }
    };

    var clipCircleCancriTropicus = {
        id: "clipCircleCancriTropicus",
        r: null,
        cx: 0,
        cy: 0,
        init: function () {
            this.r = projection(orbisDecl);
        }
    };

    var capricorniTropicusProjection = {
        id: "capricorniTropicusProjection",
        x1: 0,
        y1: null,
        x2: null,
        y2: 0,
        x: null,
        y: 0,
        init: function () {
            this.y1 =  2 * orbis.r;
            this.x = - projection(-orbisDecl);
            this.x2 = this.x;
        }
    };

    var capricorniTropicus = {
        id: "capricorniTropicus",
        r: null,
        cx: 0,
        cy: 0,
        init: function () {
            this.r = projection(-orbisDecl);
        }
    };

    var latitudoProjectionA = {
        id: "latitudoProjectionA",
        x1: 0,
        y1: null,
        x2: null,
        y2: 0,
        init: function () {
            this.y1 = 2 * orbis.r;
            this.x2 = projection(horizontis);
        }
    };

    var latitudoProjectionB = {
        id: "latitudoProjectionB",
        x1: 0,
        y1: null,
        x2: null,
        y2: 0,
        x: null,
        y: 0,
        init: function () {
            this.y1 = 2 * orbis.r;
            this.x = projection(oppositeAngle(horizontis));
            this.x2 = this.x;
        }
    };

    var latitudoHorizontis = {
        id: "latitudoHorizontis",
        r: null,
        cx: null,
        cy: 0,
        init: function () {
            var x1 = projection(horizontis);
            var x2 = projection(oppositeAngle(horizontis));
            this.cx = (x1 + x2) / 2 ;
            this.r = Math.abs(x2 - x1) / 2;
        }
    };

    var opacusProjectionA = {
        id: "opacusProjectionA",
        x1: 0,
        y1: null,
        x2: null,
        y2: 0,
        init: function () {
            this.y1 = 2 * orbis.r;
            this.x2 = projection(horizontis - opacus);
        }
    };

    var opacusProjectionB = {
        id: "opacusProjectionB",
        x1: 0,
        y1: null,
        x2: null,
        y2: 0,
        x: null,
        y: 0,
        init: function () {
            this.y1 = 2 * orbis.r;
            this.x = projection(oppositeAngle(horizontis + opacus));
            this.x2 = this.x;
        }
    };

    var opacusHorizontis = {
        id: "opacusHorizontis",
        r: null,
        cx: null,
        cy: 0,
        init: function () {
            var x1 = projection(horizontis - opacus);
            var x2 = projection(oppositeAngle(horizontis + opacus));
            this.cx = (x1 + x2) / 2 ;
            this.r = Math.abs(x2 - x1) / 2;
        }
    };

    var sunTime = {
        id: "sunTime",
        x1: 0,
        y1: 0,
        x2: null,
        y2: null,
        r: null,
        angle: 0,
        init: function() {
            this.r = scale(cancriTropicus.r);
            this.x2 = 0;
            this.y2 = scale(cancriTropicus.r * 0.95);
            var element = document.getElementById(this.id);
            element.setAttribute("y2", this.y2.toString());
        },
        show: function(angleDeg) {
            var element = document.getElementById(this.id);
            element.setAttribute("transform", "rotate(" + angleDeg + ")");
            element.setAttribute("display", "inline");
        },
        showTime: function() {
            var d = new Date();
            this.show(dateToSunTimeAngle(d));
        }
    };

    var sunSymbol = {
        id: "sunSymbol",
        angle: 0,
        r: null,
        x: null,
        y: null,
        showSun: function(angleDeg) {
            this.r = scale(cancriTropicus.r);
            var angleRad = deg2rad(angleDeg + 90);
            this.x = Math.cos(angleRad) * this.r;
            this.y = Math.sin(angleRad) * this.r;
            var element = document.getElementById(this.id);
            element.setAttribute("transform", "rotate(" + angleDeg + ")");
            element.setAttribute("display", "inline");
            var sun = document.getElementById("sunPosition");
            sun.setAttribute("transform", "translate(" + this.x + " " + this.y + ")");
            sun.setAttribute("display", "inline");
        }
    };

    var zodiacumCircle = {
        id: "zodiacumCircle",
        r: null,
        cx: null,
        cy: null,
        init: function() {
            this.r = (cancriTropicus.r + capricorniTropicus.r) / 2;
            this.cy = capricorniTropicus.r - this.r;
        }
    };

    var zodiacumEquinox = {
        id:"zodiacumEquinox",
        x1: null,
        y1: 0,
        x2: null,
        y2: 0,
        init: function() {
            this.x1 = -equator.r;
            this.x2 = equator.r;
        }
    };

    var zodiacumSolstice = {
        id:"zodiacumSolstice",
        x1: 0,
        y1: null,
        x2: 0,
        y2: null,
        init: function() {
            this.y1 = capricorniTropicus.r;
            this.y2 = - cancriTropicus.r;
        }
    };

//    document.getElementById("wall").setAttribute(
//            "style", "width:" + wall.width + "; height:" + wall.height + "; border:" + wall.border
//    );

    orbisCenter.init();
    orbis.init();
    orbisAxonX.init();
    orbisAxonY.init();
    planum.init();
    orbisEquator.init();
    equatorProjection.init();
    orbisCancriTropicus.init();
    orbisCapricorniTropicus.init();
    orbisLatitudo.init();
    orbisOpacus.init();
    cancriTropicusProjection.init();
    capricorniTropicusProjection.init();
    equator.init();
    cancriTropicus.init();
    clipCircleCancriTropicus.init();
    capricorniTropicus.init();
    latitudoProjectionA.init();
    latitudoProjectionB.init();
    latitudoHorizontis.init();
    opacusProjectionA.init();
    opacusProjectionB.init();
    opacusHorizontis.init();
    clickMePoint.init();
    sunTime.init();
    zodiacumCircle.init();
    zodiacumEquinox.init();
    zodiacumSolstice.init();


    function deg2rad(deg) {
        return deg * Math.PI / 180;
    }

    function oppositeAngle(rad) {
        return Math.PI + rad;
    }

    function projection(alpha) {
        return (2 * orbis.r * Math.tan(Math.PI / 4 + alpha/2));
    }

    function dateToSunTimeAngle(date) {
        return (date.getMinutes() + date.getHours() * 60) / 4
    }

    function drawPoint(point) {
        drawCircle({id: point.id, r: 0.05, cx: point.x, cy: point.y});
    }

    function drawCircle(obj) {
        var element = document.getElementById(obj.id);
        element.setAttribute("r", scale(obj.r));
        element.setAttribute("cx", scale(obj.cx));
        element.setAttribute("cy", scale(obj.cy));
        element.setAttribute("display", "inline");
    }

    function drawLine(line) {
        var element = document.getElementById(line.id);
        element.setAttribute("x1", scale(line.x1));
        element.setAttribute("y1", scale(line.y1));
        element.setAttribute("x2", scale(line.x2));
        element.setAttribute("y2", scale(line.y2));
        element.setAttribute("display", "inline");
    }

    function moveClickMe(x, y, onclick, color) {
        var element = document.getElementById("clickMePoint");
        element.setAttribute("onclick", onclick);
        element.setAttribute("fill", color);
        drawCircle({id: "clickMePoint", r: 0.05, cx: x, cy: y});
        var flash = document.getElementById("clickMeFlash");
        var animationName = window.getComputedStyle(flash,null).getPropertyValue("animation-name");
        if (animationName == "flash1") {
            flash.style.animationName = "flash2";
        } else {
            flash.style.animationName = "flash1";
        }
        drawCircle({id: "clickMeFlash", r: 0.1, cx: x, cy: y});
    }


    function hideClickMe() {
        document.getElementById("clickMe").setAttribute("display", "none");
    }

    function clickOrbisCenter() {
        drawLine(orbisAxonX);
        drawLine(orbisAxonY);
        drawCircle(orbis);
        drawLine(planum);
        moveClickMe(orbis.r, orbis.r, "clickOrbis()", "blue");
        drawClockNumbers();
    }

    function clickOrbis() {
        drawLine(orbisEquator);
        moveClickMe(-orbis.r, orbis.r, "clickOrbisEquatorPoint()", "violet");
    }

    function clickOrbisEquatorPoint() {
        drawLine(equatorProjection);
        moveClickMe(equatorProjection.x, equatorProjection.y, "clickEquatorProjection()", "lightgrey");
        }

    function clickEquatorProjection() {
        drawCircle(equator);
        moveClickMe(orbisCancriTropicus.x2, orbisCancriTropicus.y2, "clickOrbisCancriTropicus()", "green");
    }

    function clickOrbisCancriTropicus() {
        drawLine(orbisCancriTropicus);
        moveClickMe(orbisCancriTropicus.x1, orbisCancriTropicus.y1, "clickCancriTropicusProjectionPoint()", "green");
    }

    function clickCancriTropicusProjectionPoint() {
        drawLine(cancriTropicusProjection);
        moveClickMe(cancriTropicusProjection.x, cancriTropicusProjection.y, "clickCancriTropicusProjection()", "green");
    }

    function clickCancriTropicusProjection() {
        drawCircle(cancriTropicus);
        moveClickMe(orbisCapricorniTropicus.x2, orbisCapricorniTropicus.y2, "clickOrbisCapricorniTropicus()", "orange");
    }

    function clickOrbisCapricorniTropicus() {
        drawLine(orbisCapricorniTropicus);
        moveClickMe(orbisCapricorniTropicus.x1, orbisCapricorniTropicus.y1, "clickOrbisCapricorniTropicusPoint()", "orange");
    }

    function clickOrbisCapricorniTropicusPoint() {
        drawLine(capricorniTropicusProjection);
        moveClickMe(capricorniTropicusProjection.x, capricorniTropicusProjection.y, "clickCapricorniTropicusProjection()", "orange");
    }

    function clickCapricorniTropicusProjection() {
        drawCircle(capricorniTropicus);
        moveClickMe(orbisLatitudo.x1, orbisLatitudo.y1, "clickOrbisLatitudo()", "red");
    }

    function clickOrbisLatitudo() {
        drawLine(orbisLatitudo);
        moveClickMe(orbisLatitudo.x2, orbisLatitudo.y2, "clickOrbisLatitudoPointA()", "red");
    }

    function clickOrbisLatitudoPointA() {
        drawLine(latitudoProjectionA);
        moveClickMe(orbisLatitudo.x1, orbisLatitudo.y1, "clickOrbisLatitudoPointB()", "red");
    }

    function clickOrbisLatitudoPointB() {
        drawLine(latitudoProjectionB);
        moveClickMe(latitudoProjectionB.x, latitudoProjectionB.y, "clickLatitudoHorizontis()", "red");
    }

    function clickLatitudoHorizontis() {
        drawCircle(latitudoHorizontis);
        moveClickMe(orbisOpacus.x2, orbisOpacus.y2, "clickOrbisOpacus()", "black");
    }

    function clickOrbisOpacus() {
        drawLine(orbisOpacus);
        moveClickMe(orbisOpacus.x1, orbisOpacus.y1, "clickOrbisOpacusPointA()", "black");
    }

    function clickOrbisOpacusPointA() {
        drawLine(opacusProjectionA);
        moveClickMe(orbisOpacus.x2, orbisOpacus.y2, "clickOrbisOpacusPointB()", "black");
    }

    function clickOrbisOpacusPointB() {
        drawLine(opacusProjectionB);
        moveClickMe(opacusProjectionB.x, opacusProjectionB.y, "clickOpacusHorizontis()", "black");
    }

    function clickOpacusHorizontis() {
        drawCircle(opacusHorizontis);
        clockFaceAnimationTimer = setInterval(animateClockFace, 33);    // start animation
        hideClickMe();
    }

    function animateClockFace() {
        var element = document.getElementById("clockFace");
        var rotation = element.getAttribute("transform").match(/\d+/)[0];       // get number from string
        if (rotation < 270) {
            rotation++;
            element.setAttribute("transform", "rotate(" + rotation + ") scale(-1, 1)");
        }
        else {
            clearInterval(clockFaceAnimationTimer);     // stop this animation
            hideDesignAnimationTimer = setInterval(animateHideDesign, 100);    // start next animation
        }
    }

    function animateHideDesign() {
        var element = document.getElementById("design");
        var opacity = element.getAttribute("opacity");
        if (opacity > 0) {
            opacity -= 0.05;
            element.setAttribute("opacity", opacity);
        }
        else {
            clearInterval(hideDesignAnimationTimer);     // stop this animation
            moveOrbisAnimationTimer = setInterval(animateMoveOrbis, 50);    // start next animation
        }
    }

    function animateMoveOrbis() {
        var element = document.getElementById("orbis");
        var cy = element.getAttribute("cy");
        if (cy > 0) {
            cy -= scale(0.02 * orbis.r);      // step ralative to the perimeter
            element.setAttribute("cy", cy);
        }
        else {
            clearInterval(moveOrbisAnimationTimer);     // stop this animation
        }
    }

    function drawClockNumbers() {
        var r = scale(cancriTropicus.r);
        for (var i = 0; i < 24; i++) {
            var textElement = document.getElementById("number" + i.toString());
            var positionElement =  document.getElementById("position" + + i.toString());
            var angle = i * 15;
            var angleRad = deg2rad(angle - 90);
            var x = Math.cos(angleRad) * r;
            var y = Math.sin(angleRad) * r;
            positionElement.setAttribute("transform", "translate(" + x + " " + y + ")");
            textElement.setAttribute("transform", "rotate(" + angle + " 0,0)");
        }
        document.getElementById("numbers").setAttribute("display", "inline");
        sunTime.showTime();
        sunSymbol.showSun(dateToSunTimeAngle(new Date()));
        drawZodiacum(computeZodiacumAngleDeg(getTodayDate()));
    }

    function goSunAround() {
        var goSunAroundTimer;
        sunTime.angle = 0;
        goSunAroundTimer = setInterval(goSunAroundAnimation, 50);
        function goSunAroundAnimation() {
            var angle = sunTime.angle;
            if (angle <= 360) {
                sunTime.show(angle);
                sunSymbol.showSun(angle);
                sunTime.angle++;
            } else {
                clearInterval(goSunAroundTimer);
            }
        }
    }

    function drawZodiacum(angleDeg) {   // angleDeg from autumn equinox   (0 ... equinox, 90 ... winter solstice)
        var zodiacumGroup = document.getElementById("zodiacum");
        zodiacumGroup.setAttribute("transform", "rotate(" + angleDeg + ")");
        drawCircle(zodiacumCircle);
        drawLine(zodiacumEquinox);
        drawLine(zodiacumSolstice);
    }

    function computeZodiacumAngleDeg(date) {
        var minutesYear = 60 * 24 * 365.25;
        var equinoxDate = new Date(2016,9,22,16,20,41);    // autumn equinox
        var eh = equinoxDate.getHours();
        var em = equinoxDate.getMinutes();
        var equinoxTimeAngle = eh * 15 + em / 4;
        var value = - (((date.getTime()-equinoxDate.getTime()) / 60000 / 4 * 366 / 365 + equinoxTimeAngle) % 360);
        return value;
    }

    function getTodayDate() {
        var today= new Date();
        var s= today.getSeconds();
        var mi = today.getMinutes();
        var h = today.getHours();
        var d = today.getDate();
        var m = today.getMonth() + 1; //January is 0!
        var y = today.getFullYear();
        return new Date(y, m, d, h, mi, s);
    }

    function goZodiacumAround() {
        var goZodiacumAroundTimer;
        animationTime = new Date(2016, 1, 21, 12, 0, 0);         // GLOBAL VARIABLE
        days = 0;
        goZodiacumAroundTimer = setInterval(goZodiacumAroundAnimation, 50);
        function goZodiacumAroundAnimation() {
            var month = animationTime.getMonth();
            if (days <= 365) {
                drawZodiacum(computeZodiacumAngleDeg(animationTime));
                days++;
                var date = animationTime.getDate() + 1;
                animationTime.setDate(date);
            } else {
                clearInterval(goZodiacumAroundTimer);
            }
        }
    }


    var clockFaceAnimationTimer;
    var hideDesignAnimationTimer;
    var moveOrbisAnimationTimer;
    var goZodiacumAroundTimer;
    drawCircle(clipCircleCancriTropicus);
    drawPoint(orbisCenter);
    moveClickMe(0, orbis.r, "clickOrbisCenter()");

</script>
</html>
